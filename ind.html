<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Phishing URL Detector</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:"Poppins",sans-serif;
}

body{
  min-height:100vh;
  background:linear-gradient(135deg,#02345f,#320101);
  display:flex;
  align-items:center;
  justify-content:center;
}
/* Card */
.card{
  width:420px;
  padding:26px 28px;
  border-radius:20px;
  background:rgba(160, 59, 120, 0.295);
  box-shadow:0 20px 40px rgba(0,0,0,0.08);
  backdrop-filter:blur(12px);
}

/* Title */
h1{
  text-align:center;
  font-size:22px;
  margin-bottom:20px;
  font-weight:600;
  color:turquoise
}

/* Input wrapper */
.input-wrapper{
  position:relative;
  display:flex;
  align-items:center;
}

/* Input */
input{
  width:100%;
  padding:12px 44px 12px 14px;
  border-radius:14px;
  border:1.5px solid #d9e3f0;
  outline:none;
  font-size:14px;
}

input:focus{
  border-color:#6c8cff;
  box-shadow:0 0 0 3px rgba(108,140,255,0.15);
}

/* Paste icon button */
.paste-btn{
  position:absolute;
  right:10px;
  background:none;
  border:none;
  cursor:pointer;
  font-size:18px;
  opacity:0.7;
  transition:0.2s;
}

.paste-btn:hover{
  opacity:1;
}

/* Check button */
.check-btn{
  width:100%;
  padding:12px 16px;
  border-radius:14px;
  border:none;
  margin-top:10px;
  background:#010618;
  color:white;
  font-weight:600;
  cursor:pointer;
}

/* Result styles */
.result-box{
  margin-top:16px;
  padding:16px;
  border-radius:14px;
  font-weight:600;
  text-align:center;
  display:none;
}
.safe{
  background:#e9ffee;
  color:#1c7c36;
}

.suspicious{
  background:#fff7e8;
  color:#966000;
}

.phishing{
  background:#ffe8e8;
  color:#a30000;
}

.reason-list{
  margin-top:12px;
  font-size:13px;
  padding-left:16px;
}

</style>
</head>

<body>

<div class="card">
  <h1>Phishing URL Detector üîç</h1>

  <div class="input-wrapper">
    <input id="urlInput" placeholder="Paste website link here">
    <button class="paste-btn" onclick="pasteURL()" title="Paste from clipboard">üìã</button>
  </div>

  <button class="check-btn" onclick="checkURL()">Check</button>

  <div id="result" class="result-box"></div>
  <ul id="reasons" class="reason-list"></ul>
</div>

<script>
/* --------- SYSTEM PROMPT FOR AI ---------- */
const SYSTEM_PROMPT = `
You are a cybersecurity expert. Analyze a URL and classify it strictly as:

SAFE
SUSPICIOUS
PHISHING

Provide short reasons. Consider:
- fake login pages
- brand impersonation
- unusual domains
- IP address instead of domain
- too many subdomains
- HTTP vs HTTPS
- phishing keywords (login, verify, bank, unlock)
- shortened links
- typosquatting

Respond in the format:

VERDICT: <SAFE/SUSPICIOUS/PHISHING>
REASONS:
- reason 1
- reason 2
- reason 3
`;

/* -------- LLM API CALL ---------- */
async function enhancePrompt(userPrompt){
  try{
    const chatHistory = [
      { role: 'system', content: SYSTEM_PROMPT },
      { role: 'user', content: userPrompt }
    ];

    const response = await fetch("https://text.pollinations.ai/openai", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model: "openai",
        messages: chatHistory
      })
    });

    const data = await response.json();
    return data.choices?.[0]?.message?.content || "No AI response";
  }catch(err){
    console.error(err);
    return "AI analysis failed.";
  }
}

/* -------- Paste from clipboard ---------- */
async function pasteURL(){
  try{
    const text = await navigator.clipboard.readText();
    document.getElementById("urlInput").value = text;
  }catch(err){
    alert("Clipboard access blocked. Please paste manually.");
  }
}
/* -------- Main URL Checker ---------- */
async function checkURL(){

  const url = document.getElementById("urlInput").value.trim();
  const result = document.getElementById("result");
  const reasonsList = document.getElementById("reasons");

  reasonsList.innerHTML = "";
  result.style.display = "block";

  if(url === ""){
    result.className="result-box suspicious";
    result.innerHTML="Please enter a URL.";
    return;
  }

  let score = 0;
  let reasons = [];
  const testURL = url.toLowerCase();

  if(testURL.startsWith("http://")){
    score += 3;
    reasons.push("Uses HTTP instead of HTTPS");
  }

  if(testURL.includes("@")){
    score += 3;
    reasons.push("Contains '@' ‚Äî often used to hide true link");
  }

  const ipPattern=/(\d{1,3}\.){3}\d{1,3}/;
  if(ipPattern.test(testURL)){
    score += 3;
    reasons.push("Uses IP instead of domain");
  }

  if(url.length>70){
    score += 2;
    reasons.push("Unusually long URL");
  }

  if((url.match(/-/g)||[]).length>=3){
    score += 2;
    reasons.push("Too many hyphens");
  }

  const badWords=["verify","secure","update","free","gift","bonus","claim","reward","signin","login","bank","unlock"];
  badWords.forEach(w=>{
    if(testURL.includes(w)){
      score += 2;
      reasons.push(`Contains keyword "${w}"`);
    }
  });

  if((url.match(/\./g)||[]).length>=4){
    score += 2;
    reasons.push("Too many subdomains");
  }

  if(testURL.includes("xn--")){
    score += 3;
    reasons.push("Uses punycode");
  }

  if(score<=2){
    result.className="result-box safe";
    result.innerHTML="SAFE WEBSITE ‚úîÔ∏è";
  }else if(score<=6){
    result.className="result-box suspicious";
    result.innerHTML="SUSPICIOUS ‚ö†Ô∏è ‚Äî be careful";
  }else{
    result.className="result-box phishing";
    result.innerHTML="LIKELY PHISHING üö®";
  }

  if(reasons.length===0){
    reasonsList.innerHTML="<li>No suspicious pattern detected.</li>";
  }else{
    reasons.forEach(r=>{
      let li=document.createElement("li");
      li.textContent=r;
      reasonsList.appendChild(li);
    });
  }
/* ----------- AI INTEGRATION ----------- */

  let aiLi = document.createElement("li");
  aiLi.innerHTML = "ü§ñ AI analyzing...";
  aiLi.style.fontWeight = "600";
  aiLi.style.marginTop = "8px";
  reasonsList.appendChild(aiLi);

  const aiResponse = await enhancePrompt(
    `Analyze this URL: ${url}
Detected patterns: ${reasons.join(", ")}`
  );

  aiLi.innerHTML = "ü§ñ AI Verdict:<br>" + aiResponse.replace(/\n/g,"<br>");
}
</script>

</body>
</html>